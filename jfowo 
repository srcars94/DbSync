$dac = "C:\Program Files\Microsoft SQL Server\170\DAC\bin"
if (-not (Test-Path $dac)) { throw "DacFx path not found: $dac" }

# Add to current session PATH
$env:Path = "$dac;$env:Path"

# Persist for your user
$old = [Environment]::GetEnvironmentVariable("Path", "User")
if ($old -notlike "*$dac*") {
  [Environment]::SetEnvironmentVariable("Path", "$dac;$old", "User")
  "Added to user PATH: $dac"
} else {
  "Already on user PATH."
}

# Quick verification
& "$dac\SqlPackage.exe" /? | Out-Null
"SqlPackage is reachable."